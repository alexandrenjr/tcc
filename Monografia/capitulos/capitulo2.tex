\chapter{Região de Desempenho Garantido}

A alocação de pólos é uma das principais ferramentas da teoria de controle, pois a partir desta, é possível projetar um sistema que seja estável e que tenha um bom desempenho\cite{ROSINOVA2014}. A operação de alocar pólos de um sistema linear dentro de uma região específica é chamada $\mathscr{D}$-estabilidade\cite{CHILALI1996}.

Entende-se por estável o sistema que, em termos de resposta a estímulos, possui uma convergência ao zero da resposta natural, restando apenas a resposta forçada\cite{NISE2011}. Assim, para um intervalo de tempo determinado, espera-se que o sistema apenas tenha dinâmica referente à entrada aplicada. Neste contexto, a estabilidade é o ponto de partida para projetos de compensadores.

\section{Resposta ao impulso de um sistema linear e invariante no tempo}

A resposta ao impulso no domínio do tempo de um sistema linear e invariante no tempo tem as características da figura \ref{fig:ImpulseResponse}. O máximo da curva é o máximo sobressinal (\emph{overshoot} em inglês), onde é o pico da saída, dado normalmente em porcentagem. O parâmetro $t_s$ representa o tempo de acomodação, onde é o instante de tempo que o sinal entra em uma região da saída definida e não sai (normalmente 2\%).

\begin{figure}[!ht]
\centering
\input{figuras/ImpulseResponse.tikz}
\caption{Resposta ao impulso de um sistema de segunda ordem.}
\label{fig:ImpulseResponse}
\end{figure}

Neste contexto, a estabilidade é o número de oscilações do sistema após cessado o estímulo externo. É notável a relação com o tempo de acomodação, que de fato ocorre. Ademais, a $\mathscr{D}$-estabilidade garante um valor mínimo ou máximo a esses e outros parâmetros, dependendo da especificidade do problema. Resta apenas estudar a região de pólos para cada parâmetro considerado neste trabalho.

\section{Regiões de polos para sistemas contínuos}\label{sec:DEstabilidadeS}

Na $\mathscr{D}$-estabilidade, a região referente à estabilidade em sistema contínuos e invariantes no tempo é o semi-plano esquerdo do plano complexo. Dado um ponto genérico no plano $\s$, representado por:
\begin{equation}
\s = x + \jmath y\label{eq:PontoGenericoPlanoS}
\end{equation}
este estará na região estável se, e somente se, a parte real de tal ponto estiver à esquerda do eixo imaginário, ou em números:
\begin{equation}
\real{(\s)} < 0 \implies x < 0 \label{eq:Estabilidade}
\end{equation}

Assim, um sistema com $n$ pólos é dito estável se todos os seus pólos estão localizados à esquerda do eixo imaginário. A partir deste conceito, é possível definir estabilidade relativa: se um sistema é estável para um valor $\sigma < 0$, então aquele é dito estável relativo (ao valor de $\sigma$). A figura \ref{subfig:EstabilidadeRelativaS} mostra um esboço da região comentada. À medida que o valor de $\sigma$ aumenta em valor absoluto, mais a esquerda a reta limitante se encontra e menor o plano estável relativo se torna. Além disso, as equações de tais retas podem ser generalizadas via:
\begin{equation}
x = -|\sigma|\label{eq:Sigma}
\end{equation}

Ainda, a relação entre a estabilidade com o tempo de acomodação é dado por:
\begin{equation}
	\sigma t_s = 4 \,\,\,\,\ \text{(critério 2\%)}\label{eq:TempoAcomodacao}
\end{equation}

Logo, projetar um compensador a partir da taxa de amortecimento ou do tempo de acomodação se torna intercambiável via \eqref{eq:TempoAcomodacao}, uma vez conhecido o outro parâmetro. Em adição a isso, como a relação é inversamente proporcional, ao exigir um tempo de acomodação relativamente pequeno, pode resultar em um número grande de oscilações.

Outros parâmetros de desempenho importantes para projetos de compensadores são o fator de amortecimento $\zeta$ e a frequência natural não-amortecida $\omega_n$. São facilmente caracterizados a partir da resposta de sistemas de segunda ordem à função degrau\cite{NISE2011,OGATA2011} e representam as oscilações não-amortecidas do modelo físico. Dado um par de pólos conjugados via \eqref{eq:PontoGenericoPlanoS}, é possível reescrevê-los em termos daqueles parâmetros:
\begin{equation}
s = -\zeta\omega_n \pm \jmath\omega_n \sqrt {1-\zeta^2} \label{eq:PontoPlanoS}
\end{equation}
com $\sigma = -\zeta\omega_n$. As regiões de $\mathscr{D}$-estabilidade referente a tais parâmetros são obtidos fixando um deles em \eqref{eq:PontoPlanoS} e variando o outro em um certo intervalo. Por esse motivo, \eqref{eq:PontoPlanoS} pode ser entendido como uma função de duas variáveis, dado como:
\begin{equation}
s(\zeta,\omega_n) = -\zeta\omega_n \pm \jmath\omega_n \sqrt {1-\zeta^2} \label{eq:FuncaoPontoPlanoS}
\end{equation}

Com isso, é possível analisar as regiões geradas a partir de tais parâmetros. A região $\zeta$-constante é obtida fixando-se um valor para $\zeta$ e variando-se o valor de $\omega_n$. As características obtidas são representadas na figura \ref{subfig:MaximoSobressinalS}. Os ângulos formados entre as retas e o eixo imaginário têm valores absolutos $\beta = -\cotg{\left(\arccos{\left(\zeta\right)}\right)}$ e diminuem à medida que o valor de $\zeta$ aumenta, tornando a região estreita.

Já as regiões $\omega_n$-constante possuem as características esboçadas na figura \ref{subfig:OscilacaoNaoAmortecidaS}. Os raios das semicircunferências formadas possuem valores iguais à $\omega_n$ e aumentam ou diminuem à medida que se varia tal parâmetro. Conforme abordado em \citeonline{CHILALI1996}, a intersecção das regiões comentadas formam a Região $\Omega$ de Desempenho garantido. Todos os polos dentro de tal região possuem um mínimo valor de $\sigma$, $\zeta$ e $\omega_n$.

\begin{figure}[!hb]
\centering
\begin{subfigure}[t]{0.3\columnwidth}
\input{figuras/ssigma.tikz}
\caption{}
\label{subfig:EstabilidadeRelativaS}
\end{subfigure}
\begin{subfigure}[t]{0.3\columnwidth}
\input{figuras/szeta.tikz}
\caption{}
\label{subfig:MaximoSobressinalS}
\end{subfigure}
\begin{subfigure}[t]{0.35\columnwidth}
\input{figuras/swn.tikz}
\caption{}
\label{subfig:OscilacaoNaoAmortecidaS}
\end{subfigure}
\caption{Regiões de $\mathscr{D}$-estabilidade do plano $\s$. Em \subref{subfig:EstabilidadeRelativaS} encontram-se retas verticais para vários valores de $\sigma$, sendo $|\sigma_2| > |\sigma_1|$. Em \subref{subfig:MaximoSobressinalS} encontram-se retas para vários valores de $\zeta$, sendo $\zeta_2 > \zeta_1$. Em \subref{subfig:OscilacaoNaoAmortecidaZ} encontram-se circunferências de raios $r = \omega_n$, sendo $\omega_{n2} > \omega_{n1}$.}
\label{fig:RegioesPlanoS}
\end{figure}

\section{Regiões de polos para sistemas discretos}\label{sec:DEstabilidadeZ}

As regiões de $\mathscr{D}$-estabilidade para sistemas discretos são obtidas seguindo os mesmos métodos abordados nos contínuos, com a diferença de serem descritos no plano $\z$. A transformada de um ponto do plano $\s$ para $\z$ é dada por:
\begin{equation}
\z = \exp(\s T_s)\label{eq:TransformacaoSZ}
\end{equation}
onde $T_s$ é o período de amostragem, parâmetro importante para sistemas discretos\cite{KUO1980}. Substituindo \eqref{eq:PontoPlanoS} em \eqref{eq:TransformacaoSZ}, chega-se a seguinte relação:
\begin{equation}
\z = \exp{\left(-\zeta\omega_nT_s \pm j\omega_nT_s\sqrt{1-\zeta^2}\right)}\label{eq:PontoPlanoZ}
\end{equation}

A $\sigma$-estabilidade nos contínuos foi encontrada verificando a parte real dos pólos. Utilizando-se da mesma ideia, ao analisar apenas a parte real de \eqref{eq:PontoPlanoZ} (igualando a parte imaginária a zero), chega-se na seguinte relação:
\begin{equation}
\z = \exp{\left(-|\sigma|T_s\right)}\label{eq:EstabilidadeRelativaZ}
\end{equation}
onde $\sigma = -\zeta\omega_n$. Tal função descreve uma circunferência com raio $r = |\sigma|$ no plano complexo. Recordando \eqref{eq:Estabilidade} e \eqref{eq:Sigma}, quando $\sigma = 0$ em \eqref{eq:EstabilidadeRelativaZ}, a circunferência gerada possui raio unitário. Dessa maneira, a região estável nos sistemas discretos é o interior de uma circunferência unitária. A figura \ref{subfig:EstabilidadeRelativaZ} mostra esboços para vários valores de $\sigma$.

Assim como realizado nos sistemas contínuos, \eqref{eq:PontoPlanoZ} pode ser enxergada em função de $\zeta$ e $\omega_n$:

\begin{equation}
\z(\zeta,\omega_n) = \exp{\left(-\zeta\omega_nT_s \pm j\omega_nT_s\sqrt{1-\zeta^2}\right)}\label{eq:FuncaoPontoZ}
\end{equation}

\noindent e a partir desta, é possível descrever as regiões geradas a partir de tais parâmetros. A região $\zeta$-constante possui o formato apresentado na figura \ref{subfig:MaximoSobressinalZ}. Devido ao exponencial, as curvas geradas assemelham-se a cardióides, mas não o são, pois denominam-se espirais logarítmicas.
\begin{figure}[!ht]
\centering
\begin{subfigure}[t]{0.3\columnwidth}
\input{figuras/zsigma.tikz}
\caption{}
\label{subfig:EstabilidadeRelativaZ}
\end{subfigure}
\begin{subfigure}[t]{0.3\columnwidth}
\input{figuras/zzeta.tikz}
\caption{}
\label{subfig:MaximoSobressinalZ}
\end{subfigure}
\begin{subfigure}[t]{0.3\columnwidth}
\input{figuras/zwn.tikz}
\caption{}
\label{subfig:OscilacaoNaoAmortecidaZ}
\end{subfigure}
\caption{Regiões de $\mathscr{D}$-estabilidade do plano $\z$. Em \subref{subfig:EstabilidadeRelativaZ} encontram-se circunferências com valores de raios crescentes, sendo $|\sigma_2| > |\sigma_1|$. Em \subref{subfig:MaximoSobressinalZ} encontram regiões $\zeta$-constantes com áreas decrescentes em relação à $\zeta$, sendo $\zeta_2 > \zeta_1$. Em \subref{subfig:OscilacaoNaoAmortecidaZ} encontram-se regiões semelhantes à cardióides que possuem áreas crescentes em relação à $\omega_n$, sendo $\omega_2 > \omega_1$.}
\label{fig:RegioesPlanoZ}
\end{figure}

Ambos os ramos começam a ser desenhados a partir de $(1,0)$ (quando $\omega_n = 0 = \omega_{nmin}$), e se deslocam no sentido anti-horário, até cruzarem o eixo real pela primeira vez. À medida que o valor de $\omega_n$ aumenta, mais voltas o contorno dá. E a cada $n$ meia-volta, o contorno cruza o eixo real pela $n$-ésima vez, conforme esboçado na figura \ref{fig:EspiralLogaritmica}. Como a espiral tende para dentro da região limitada pela primeira volta, somente a primeira volta é considerada no plano $\z$.

\begin{figure}[!ht]
\centering
\input{figuras/espiral_logaritmica.tikz}
\caption{Espiral logarítmica com 3 meia-voltas gerada a partir de \eqref{eq:FuncaoPontoZ} com $\zeta=0.5$ constante.}
\label{fig:EspiralLogaritmica}
\end{figure}

O valor de $\omega_n$ no qual os ramos cruzam o eixo imaginário a cada $n$ meia-volta é encontrado quando o argumento de \eqref{eq:FuncaoPontoZ} é igual à $\pi$ (meia volta da espiral, em radianos), isto é:
\begin{align}
\arg{\left(\z(\zeta,\omega_{nmax})\right)} &= \pi \implies \omega_{nmax} = \dfrac{\pi}{T_s\sqrt{1-\zeta^2}}\label{eq:PontoExtremoZetaZ}
\end{align}

Assim, ambos os ramos cruzam o eixo imaginário pela primeira vez quando $\omega_n = \omega_{nmax}$, para o respectivo valor fixado de $\zeta$. Ainda, outra característica que pode ser citada é a influência do $\zeta$ na região: quanto maior seu valor, menor a área da região $\zeta$-constante equivalente, assim como ocorre com seu dual nos contínuos.

Em relação às regiões $\omega_n$-constante, como o estudo de alocação de pólos se restringe a sistemas de segunda ordem subamortecidos\cite{NISE2011,OGATA2011}, os valores possíveis para a taxa de amortecimento está no intervalo $0 < \zeta < 1$. Dito isso, os ramos esboçados na figura \ref{subfig:OscilacaoNaoAmortecidaZ} começam a ser desenhados a partir da circunferência unitária, onde o ponto é dado por $\z(\zeta_{min},\omega_n)$ (com $\zeta = 0 = \zeta_{min}$) e vão em direção ao ponto $\z(\zeta_{max},\omega_n)$, com $\zeta_{max} = 1$.

Com tais pontos extremos, é possível aproximar as regiões do plano $\z$ utilizando Desigualdades Matriciais Lineares (LMIs, em inglês). Esse estudo será abordado na seção a seguir.

\section{Aproximação das regiões do plano z via LMIs}
Em estudos anteriores, foram abordadas técnicas utilizando LMIs para mapear as regiões de $\mathscr{D}$-estabilidade no plano $s$. Tal feito foi realizado devido à convexidade de tais regiões, requisito para o uso de LMIs. Conforme visto na subseção \ref{sec:DEstabilidadeZ}, as regiões $\zeta$-constante e $\omega_n$-constante no plano $\z$ podem possuir características não-convexas, o que impossibilita o mapeamento exato via LMIs.

Estudos foram desenvolvidos para contornar a não-convexidade de algumas regiões do plano $\z$, aproximando-os em regiões convexas. Em 2014, no artigo \citeonline{ROSINOVA2014}, \citeauthoronline{ROSINOVA2014} mapeou a região $\zeta$-constante utilizando a maior elipse ou circunferência inscrita possível. Mas foi em \citeonline{ROSINOVA2019} que foi desenvolvido um algoritmo que traz várias aproximações utilizando elipses, para aproveitar da melhor forma a área daquela região.

Já em \citeonline{WISNIEWSKI2017} foi abordada uma aproximação cônica, utilizando-se apenas de quatro pontos e, consequentemente, dois setores cônicos. Apesar de simples, a ideia poderia facilmente ser estendida para $n$ pontos, o que foi feito em \citeonline{WISNIEWSKI2019}. Ao aumentar a área a cada iteração, o algoritmo verifica a solução proposta.

E finalmente, utilizando-se das ideias anteriores, \citeauthoronline{CHIQUETO2021} em \citeonline{CHIQUETO2021} trouxe aproximações cônica, elíptica e poligonal da região $\omega_n$-constante.

\section{Modelagem via espaço de estados}
O espaço de estados é uma representação matemática desenvolvida na Teoria de Controle para estudar sistemas físicos, relacionando saídas, entradas e variáveis de estado internas, através do uso de Equações Diferenciais Ordinárias (EDOs).

Se o sistema a ser analisado for contínuo, linear e invariante no tempo, então as variáveis de estado deste podem ser representadas através de vetores, enquanto as EDOs correspondentes são descritas de forma matricial, como segue:
\begin{subequations}
\label{eq:SSC}
\begin{align}
\dot{\pmb{\mathrm{x}}} &= A\pmb{\mathrm{x}} + B\pmb{\mathrm{u}}\label{eq:SSCEntrada}\\
\pmb{\mathrm{y}} &= C\pmb{\mathrm{x}} + D\pmb{\mathrm{u}}\label{eq:SSCSaida}
\end{align}
\end{subequations}

\noindent onde:

\begin{itemize}
\item $\dot{\pmb{\mathrm{x}}}$, $\pmb{\mathrm{x}} \in \mathbb{R}^n$, $\pmb{\mathrm{u}} \in \mathbb{R}^m$ e $\pmb{\mathrm{y}} \in \mathbb{R}^p$;
\item $A \in \mathbb{R}^{n \times n}$ é a matriz de estado;
\item $B \in \mathbb{R}^{n \times m}$ é a matriz de entrada;
\item $C \in \mathbb{R}^{p \times n}$ é a matriz de saída;
\item $D \in \mathbb{R}^{p \times m}$ é a matriz de transmissão direta.
\end{itemize}

Já a representação no espaço de estados de um sistema discreto, linear e invariante no tempo é:
\begin{subequations}
\label{eq:SSD}
\begin{align}
\pmb{\mathrm{x^+}} &= A\pmb{\mathrm{x}} + B\pmb{\mathrm{u}}\label{eq:SSDEntrada}\\
\pmb{\mathrm{y}} &= C\pmb{\mathrm{x}} + D\pmb{\mathrm{u}}\label{eq:SSDSaida}
\end{align}
\end{subequations}

Em ambos os domínios, os pólos do sistema são os autovalores da matriz de estado. Logo, um sistema representado via espaço de estados é dito estável se todos os polos da matriz $A$ estão no semi-plano esquerdo ou no interior de uma circunferência unitária.

\section{Condição de Lyapunov}\label{sec:LyapunovCondition}
Seja $\mathcal{D}$ um subconjunto do plano contínuo, localizado no semi-plano esquerdo e um sistema representado como em \eqref{eq:SSC} ou \eqref{eq:SSD}. Este conjunto é dito $\mathcal{D}$-estável se todos os autovalores da matriz de estado correspondente estiverem contidos em $\mathcal{D}$.

Caso $\mathcal{D}$ for uma região convexa, é possível mapeá-la utilizando Desigualdades Matriciais Lineares (LMIs em ingîes)\cite{CHILALI1996}, através da condição de Lyapunov. A partir disso, uma matriz $A$ é estável se, e somente se, existir uma matriz simétrica $P$, tal que:
\begin{equation}
AP + PA' \prec 0, \qquad P \succ 0\label{eq:LyapunovConditionS}
\end{equation}

\noindent para o caso contínuo. Já para o caso discreto, a condição de Lyapunov é dada por:
\begin{equation}
A'PA - P \prec 0, \qquad P \succ 0\label{eq:LyapunovConditionD}
\end{equation}

\noindent onde \lq{}\lq{}$P \succ 0$\rq{}\rq{} se lê \lq{}\lq{}P é positiva definida\rq{}\rq{}.

\section{Regiões LMIs de interesse}
Definidos LMIs, algumas regiões LMIs são apresentadas neste trabalho para as aproximações estudadas. Uma primeira região que pode ser citada é todo o interior de uma circunferência de raio $r$, dado no plano $\z$:
\begin{equation}
\begin{bmatrix*}[c]
-rP & * \\
PA + Z'B & -rP
\end{bmatrix*}
\prec 0\label{eq:LMIEstabilidadeRelativa}
\end{equation}

\noindent com $r = \exp{\left(-|\sigma|T_s\right)}$. Outra região de interesse é um setor cônico com centro em $\alpha$ e ângulo $\theta$. Tal plano é simétrico em relação ao seu centro. Portanto, o mapeamento realizado via LMI leva em consideração essa simetria. Contudo, através de manipulações algébricas, a região LMI de um setor cônico voltado para a esquerda é definida como:
\begin{equation}
\begin{bmatrix*}[c]
\sen{(\theta)(\Herm{(AP)} + \Herm{(BZ)} -2\alpha P)} & * \\
\cos{(\theta)(\herm{(PA')} + \herm{(Z'B')})} & \sen{(\theta)(\Herm{(AP)} + \Herm{(BZ)} -2\alpha P)}
\end{bmatrix*}
\prec 0\label{eq:LMIESetorConicoEsquerdo}
\end{equation}

\noindent com seu lado direito dado como:
\begin{equation}
\begin{bmatrix*}[c]
\sen{(\theta)(2\alpha P - \Herm{(AP)} - \Herm{BZ})} & * \\
\cos{(\theta)(\herm{(PA')} + \herm{Z'B'})} & \sen{(\theta)(2\alpha P - \Herm{(AP)} - \Herm{(BZ)})}
\end{bmatrix*}
\prec 0\label{eq:LMIESetorConicoDireito}
\end{equation}
Para desconsiderar a simetria do setor cônico direito, é definido uma reta limitante em $\alpha$, dado por:

\begin{equation}
AP + BZ + Z'B' + PA' -2\alpha P\label{eq:LMIRightBounded} \succ 0
\end{equation}

\noindent onde considera a área à direita de tal reta. Isso é necessário apenas para o setor cônico direito, pois o voltado para a esquerda é limitado por \eqref{eq:LMIEstabilidadeRelativa}, como pode ser observado na figura \ref{fig:RegioesPlanoZ}. Uma última região LMI é apresentada: uma elipse, que possui a seguinte equação\cite{CHIQUETO2021}:
\begin{equation}
\mathbb{E}: \dfrac{(x-1)^2}{\left(1-\exp{\left(-\frac{2\pi}{N_y}\right)}\right)^2} + \dfrac{\left(\left(1-\exp{\left(-\frac{2\pi}{N_y}\right)}\right)^2 - \left(\cos{\left(\frac{2\pi}{N_y}\right)} - 1\right)^2\right)y^2}{\left(1-\exp{\left(-\frac{2\pi}{N_y}\right)}\right)^2\sen{\left(\frac{2\pi}{N_y}\right)}} = 1\label{eq:Elipse}
\end{equation}

\noindent onde $N_y$ é relação entre a frequência de amostragem e a frequência natural não-amortecida, dada por:
\begin{equation}
N_y = \dfrac{\omega_s}{\omega_n} = \dfrac{2\pi}{\omega_nT_s}\label{eq:ConstanteNy}
\end{equation}

A LMI correspondente é dada por:

\begin{equation}
\begin{bmatrix*}[c]
-P & *\\
-\dfrac{1}{a}P + \dfrac{1}{2}\left(\dfrac{1}{a}+\dfrac{1}{b}\right)AP + \dfrac{1}{2}\left(\dfrac{1}{a}-\dfrac{1}{b}\right)PA' & -P
\end{bmatrix*}
\prec 0\label{eq:LMIElipse}
\end{equation}

\noindent onde:
\begin{subequations}
\label{eq:PontosElipse}
\begin{align}
a &= \left(1-\exp{\left(\frac{-2\pi}{N_y}\right)}\right)\label{eq:PontoAElipse}\\
b &= a\sen{\left(\frac{2\pi}{Ny}\right)}\label{eq:PontoBElipse}
\end{align}
\end{subequations}

\section{Solução de LMIs}
Conforme visto na seção anterior, as LMIs apresentadas foram desenvolvidas a partir da condição de Lyapunov (seção \ref{sec:LyapunovCondition}). Uma vez definidas tais desigualdades, basta apenas alocar os pólos dentro da região desejada. Tal operação pode ser feita analiticamente. Contudo, como a complexidade aumenta com a ordem do sistema, esta tarefa é delegada a solucionadores numéricos.

Neste contexto, a programação semi-definida é usada para tal ação, uma vez que a $\mathscr{D}$-estabilidade pode ser enxergada como um problema de otimização. Dessa forma, ao definir as restrições via LMIs, basta apenas otimizar o problema utilizando um dos vários solucionadores disponíveis.